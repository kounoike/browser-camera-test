{"version":3,"sources":["CameraList.tsx","CameraViewer.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["a","navigator","mediaDevices","getUserMedia","video","audio","enumerateDevices","CameraList","useState","devices","setDevices","cameraList","setCameraList","useEffect","getCameraList","then","filter","d","kind","map","label","type","value","deviceId","contentEditable","CameraViewer","props","el","useRef","document","createElement","settings","setSettings","constraint","JSON","parse","console","log","stream","oldStream","current","srcObject","getVideoTracks","forEach","c","stop","stringify","t","getSettings","onloadedmetadata","play","e","ref","style","object_fit","width","height","rows","cols","App","setConstraint","actualConstraint","setActualConstraint","onChange","ev","target","onClick","colSpan","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"uTAEA,sBAAAA,EAAA,sEACQC,UAAUC,aAAaC,aAAa,CACxCC,OAAO,EACPC,OAAO,IAHX,gCAKSJ,UAAUC,aAAaI,oBALhC,4C,sBAiCeC,MAzBf,WAAuB,IAAD,EACUC,mBAA4B,IADtC,mBACbC,EADa,KACJC,EADI,OAEgBF,mBAAS,IAFzB,mBAEbG,EAFa,KAEDC,EAFC,KAiBpB,OAbAC,qBAAU,Y,2CACRC,GAAgBC,MAAK,SAACN,GAAD,OAA+BC,EAAWD,QAC9D,IACHI,qBAAU,WACRD,EAAcH,EAAQO,QAAO,SAAAC,GAAC,MAAe,eAAXA,EAAEC,QACjCC,KAAI,SAAAF,GAAC,OACR,+BACE,6BAAKA,EAAEG,QACP,6BAAI,uBAAOC,KAAK,OAAOC,MAAK,WAAML,EAAEM,SAAR,KAAqBC,iBAAiB,QAF3DP,EAAEM,gBAKV,CAACd,IAGF,kCACE,gCAAO,+BAAI,oDAAY,+CACvB,gCAAQE,QCgBCc,EAxCuB,SAAAC,GACpC,IAAMC,EAAKC,iBAAOC,SAASC,cAAc,UADI,EAEbtB,mBAAS,IAFI,mBAEtCuB,EAFsC,KAE5BC,EAF4B,KAI7CnB,qBAAU,WACR,IACE,IAAMoB,EAAaC,KAAKC,MAAMT,EAAMO,YACpCG,QAAQC,IAAIJ,GACZhC,UAAUC,aAAaC,aAAa8B,GAAYlB,MAAK,SAAAuB,GACnDF,QAAQC,IAAI,iBACZ,IAAME,EAAYZ,EAAGa,QAAQC,UAC1BF,GACDA,EAAUG,iBAAiBC,SAAQ,SAAAC,GAAC,OAAIA,EAAEC,UAE5Cb,EAAYE,KAAKY,UAAUR,EAAOI,iBAAiBvB,KAAI,SAAA4B,GAAC,OAAIA,EAAEC,iBAAgB,KAAM,OACpFrB,EAAGa,QAAQC,UAAYH,EACvBX,EAAGa,QAAQS,iBAAmB,WAC5BtB,EAAGa,QAAQU,WAGf,MAAMC,GACNf,QAAQC,IAAIc,MAGb,CAACzB,EAAMO,aAQV,OACE,gCACE,uBAAOmB,IAAKzB,EAAI0B,MARD,CACjBC,WAAY,aACZC,MAAO,IACPC,OAAQ,OAMN,0BAAUC,KAAM,GAAIC,KAAM,GAAIlC,iBAAiB,EAAOF,MAAOS,QCHpD4B,MAjCf,WAAgB,IAAD,EACuBnD,mBAAS,8FADhC,mBACNyB,EADM,KACM2B,EADN,OAQmCpD,mBAASyB,GAR5C,mBAQN4B,EARM,KAQYC,EARZ,KAab,OACE,8BACE,iCACE,gCACE,kCACE,+BACE,6BAAI,cAAC,EAAD,MACJ,6BAAI,0BAAUxC,MAAOW,EAAY8B,SACrC,SAACC,GAAD,OAAQJ,EAAcI,EAAGC,OAAO3C,QAClCmC,KAAM,GAAIC,KAAM,OACV,6BAAI,wBAAQQ,QAbJ,WAClBJ,EAAoB7B,IAYN,+BAEN,6BAAI,oBAAIkC,QAAS,EAAb,SAAgB,cAAC,EAAD,CAAclC,WAAY4B,kBChB3CO,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBvD,MAAK,YAAkD,IAA/CwD,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCHdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFjD,SAASkD,eAAe,SAM1BX,M","file":"static/js/main.aaf10516.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\n\nasync function getCameraList(): Promise<MediaDeviceInfo[]> {\n  await navigator.mediaDevices.getUserMedia({\n    video: true,\n    audio: false\n  });\n  return navigator.mediaDevices.enumerateDevices();\n}\n\nfunction CameraList() {\n  const [devices, setDevices] = useState<MediaDeviceInfo[]>([]);\n  const [cameraList, setCameraList] = useState([] as any[]);\n  \n  useEffect(() => {\n    getCameraList().then((devices:MediaDeviceInfo[]) => setDevices(devices));\n  }, []);\n  useEffect(() => {\n    setCameraList(devices.filter(d => d.kind === 'videoinput')\n      .map(d => \n    <tr key={d.deviceId}>\n      <td>{d.label}</td>\n      <td><input type=\"text\" value={`\"${d.deviceId}\"`} contentEditable={false}></input></td>\n    </tr>\n    ));\n  }, [devices])\n\n  return (\n    <table>\n      <thead><tr><th>ラベル</th><th>deviceId</th></tr></thead>\n      <tbody>{cameraList}</tbody>\n    </table>\n  );\n}\n\nexport default CameraList;\n","import React, { useEffect, useRef, useState } from 'react';\n\ntype Props = {\n  constraint: string;\n}\n\nconst CameraViewer: React.FC<Props> = props => {\n  const el = useRef(document.createElement(\"video\"));\n  const [settings, setSettings] = useState(\"\");\n\n  useEffect(() => {\n    try{\n      const constraint = JSON.parse(props.constraint);\n      console.log(constraint);\n      navigator.mediaDevices.getUserMedia(constraint).then(stream => {\n        console.log(\"Stream opened\");\n        const oldStream = el.current.srcObject as MediaStream;\n        if(oldStream) {\n          oldStream.getVideoTracks().forEach(c => c.stop());\n        }\n        setSettings(JSON.stringify(stream.getVideoTracks().map(t => t.getSettings()), null, \"  \"));\n        el.current.srcObject = stream;\n        el.current.onloadedmetadata = () => {\n          el.current.play();\n        };\n      })\n    } catch(e) {\n      console.log(e);\n    }\n\n  }, [props.constraint]);\n\n  const videoStyle = {\n    object_fit: \"scale_down\",\n    width: 320,\n    height: 180\n  }\n\n  return (\n    <div>\n      <video ref={el} style={videoStyle}></video>\n      <textarea rows={20} cols={80} contentEditable={false} value={settings}></textarea>\n    </div>\n  );\n};\n\nexport default CameraViewer;\n","import React, { useState } from 'react';\nimport './App.css';\nimport CameraList from './CameraList';\nimport CameraViewer from './CameraViewer';\n\nfunction App() {\n  const [constraint, setConstraint] = useState(`{\n  \"video\": {\n    \"deviceId\": \"default\",\n    \"width\": 1280,\n    \"height\": 720\n  }\n}`);\n  const [actualConstraint, setActualConstraint] = useState(constraint);\n\n  const handleClick = () => {\n    setActualConstraint(constraint);\n  };\n  return (\n    <div>\n      <header>\n        <table>\n          <tbody>\n            <tr>\n              <td><CameraList></CameraList></td>\n              <td><textarea value={constraint} onChange={\n          (ev) => setConstraint(ev.target.value)}\n        rows={20} cols={80}></textarea></td>\n              <td><button onClick={handleClick}>反映</button></td>\n            </tr>\n            <tr><td colSpan={3}><CameraViewer constraint={actualConstraint}></CameraViewer></td></tr>\n          </tbody>\n        </table>\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);  \n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n}\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}